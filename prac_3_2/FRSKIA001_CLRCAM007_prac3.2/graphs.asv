clc;
clear;

speedup = [0.00109289617486339	0.00628366247755835	0.0144020037570445	0.0292207792207792	0.06503884572697	0.0981366459627329	0.184321045263649	0.207066381156317	0.281458333333333	0.366247755834829	0.539622641509434	0.550979680696662	0.683421159302797	0.836107014956815	0.705105372514099	0.777763175187278	1.13171904516572	1.12213302752294	1.3038377986966	1.59055588762702	1.96042518397383	1.9355702805583	2.61372257958107	2.9895920765486	2.95172615564658	3.3908969210174	4.33522822270523	4.30431491294474	5.16006389776358	6.33058419243986	5.40330754867965	6.05508948545861	7.0234223482023	8.03180212014134	6.17869796279894	6.12206671577397	8.02924824752236	9.13580078922303	10.7946808510638	10.7440529194759;
0.000698421567257997	0.00386029411764706	0.0125050423557886	0.0301399354144241	0.0557104771243833	0.101144521736362	0.150659569544087	0.215154575463877	0.299116867824551	0.401174197384067	0.51620233012519	0.638203686174063	0.758761567880125	0.927292899408284	1.11179483531337	1.27768961106637	1.56885960799025	1.85252147573183	2.11475687772679	2.32669291775276	2.50780318403381	2.86842973842726	3.2362209502235	3.73982392542724	4.20690140561845	4.71429861257411	5.33607840862959	5.60988525188844	6.23894273127753	6.45321626916372	6.99274770536332	7.84958584337349	9.11229622001342	9.30493898590364	9.33461829976936	9.44465890960034	11.1668618127076	11.752942018953	11.9196158075447	9.10816766467066;
0.00250757496604326	0.00480653950953678	0.0165831909417993	0.0390154627299087	0.073272047214328	0.124369379249836	0.18398765614029	0.256703148067201	0.355335917103151	0.497955988518744	0.604542682238135	0.737828424182647	0.926811555697256	1.10152477074177	1.32024773077301	1.50969652865551	1.73049137428532	1.94440756965647	2.19701452432202	2.36771691946206	2.64174877951898	3.13386892546828	3.52182647607029	3.70096039534721	4.157572589004	4.69204794173151	5.12264741001876	5.45852403303608	5.91124013489553	6.06568311391319	6.62724547136293	6.7322962501314	7.59906063652071	7.69533165806279	7.46445403934966	8.03621913794364	8.1830759681066	8.6964168798266	10.6605825357788	14.8416826923077;
0.000729873731844391	0.00477280561423357	0.0175622229559329	0.0435705770882173	0.0953881733256002	0.115275573703261	0.184607582977896	0.259096213886959	0.355614012156068	0.462575486396353	0.594143957265242	0.731644403769196	0.920183729599173	1.09861833269059	1.2977422066888	1.57790629957628	1.8723688085792	2.22256826965274	2.42523312573259	2.62755604711326	2.87157777023384	3.1105010500489	3.51845158659549	3.76382305772548	4.20272953499059	4.78996618967932	5.25552189656397	5.21977761595074	5.6370412538025	6.10828428644345	6.48799504778333	6.77009891770212	7.16259434807971	7.43538290981444	7.67727251076802	7.7771355544546	7.92181537114062	8.55444420777766	9.15029166745326	7.43958965848875;
0.000701959637320854	0.00530168554328532	0.0196581416933072	0.0536132321452952	0.10218305533242	0.156785483684045	0.233758132649862	0.329651052678968	0.472855340041329	0.607817778556708	0.754828537642885	0.917176395004885	1.12894561603719	1.24541693490144	1.46541869719551	1.67449417875952	1.90134873321935	2.08264177745469	2.26541359532623	2.55880881934422	2.78129667270208	3.1708241439955	3.52493973398008	3.81699812717382	4.11723537943614	4.58768720206611	5.13240346635573	5.22517398124451	5.54414930900407	5.80205596677313	6.10952285790317	6.27377337382132	6.57000230946036	6.90165436895934	7.09439261288847	7.15312502928105	7.51134005193759	7.95294185779707	8.44096249710292	9.13953996214878;
0.000776212085025078	0.00660113367295688	0.0217334736891906	0.0624039938556067	0.116256353265587	0.178809562272925	0.26888388687277	0.376093438067726	0.509394524786668	0.660835539498698	0.795472014361019	1.03790697137047	1.13582989527134	1.31001169521675	1.52259550855906	1.70828079173692	1.944943947912	2.19339905888005	2.38717533672909	2.5912388037379	2.79528937073215	3.12132524612447	3.53425043119969	3.69760606456079	3.85268801986156	4.49757060786991	4.88195677418488	4.96257868214102	5.39521524339542	5.49921413718522	6.00193558344909	6.06601992440083	6.44932703682946	6.88344625300113	7.17038072549603	7.14456787062755	7.68048614532742	7.94665654459974	7.95587947277435	10.8133544856598;
0.00109431639422748	0.00748496324348407	0.0268985020267374	0.0697772721904158	0.129817221232471	0.213704740388911	0.315915849695722	0.444270944097606	0.59411159428823	0.766965353725222	0.910806220540734	1.10971501725242	1.16488325032296	1.36389783805631	1.46315183720446	1.61819444920924	1.88345777027718	2.1231831102396	2.38742395301657	2.61472766278082	2.90123762990153	3.11908800659805	3.61334624307777	3.70848303653676	4.07298212357201	4.43882312622643	4.81420076658668	4.91260894809948	5.14436701996992	5.67288241017345	5.70837918597699	5.65486706293991	6.01459970624142	6.33563641024871	6.71337748965819	7.10362820483418	7.65397553492244	8.36097086164379	8.57944824636442	8.86232460941387;
0.0008261475706098	0.00777424051382435	0.0325897108172379	0.0767638916077072	0.150154164216079	0.232263638461675	0.339921199430052	0.505851712474273	0.652561726835986	0.853930187016299	0.992248945628633	1.10581178090274	1.18839409839006	1.32502923457229	1.4581802146112	1.61975451609522	1.86969771361398	2.06533038880179	2.35917978514095	2.57975827581122	2.76855458207424	2.91737948722941	3.29554104942638	3.59819116900746	3.86528275786753	4.24774632802599	4.49399286020682	4.80969449403043	5.14675234966176	5.33036321865106	5.70135751930614	5.98684034084327	6.51698853315801	7.09016691295816	7.6105458814322	8.02759693788281	8.71061082823796	9.13609661272345	9.77247332390271	9.52046345602434;
0.00108572721103823	0.00678311757403795	0.0354622504344126	0.0751063185345156	0.142581722687947	0.235687550362057	0.375527182390664	0.522127825724018	0.705192001964611	0.915109563549825	1.05389285571111	1.16906405903946	1.27993726968228	1.44301880383012	1.52982894718965	1.64560782842799	1.80776619448741	2.03096052701227	2.20904742202188	2.43715431314561	2.74806551614714	2.93809993326698	3.13197503697351	3.2974310688407	3.6482747188289	3.98510635109348	4.32721762624185	4.78094098434171	5.31170491030734	5.51657063434918	5.87245111426079	6.1787832406136	6.69404671727568	7.14721283425056	7.83624892098095	8.37939578647799	9.07449728933912	9.42259596387409	11.0082457418441	12.2806267044543;
0.00062613486945088	0.00651041046995836	0.0369911636838211	0.0819939436291637	0.159425367904695	0.242302509470901	0.386097451604813	0.557929165313172	0.746819586867787	0.995501891224215	1.14065459707738	1.24793099675665	1.326553172673	1.41833029919673	1.51151267331506	1.57610170979073	1.85097281295209	2.10820596665781	2.33533795156775	2.54658888543801	2.76685657117118	3.06451854969944	3.1982052765138	3.39288810721098	3.75962524377249	4.00416861492618	4.24316439599182	4.71348975891706	5.14765961804097	5.45379483284999	5.98436307370861	6.36858212163159	7.22861774457393	7.74321042530939	8.60339085054474	9.19909020852177	9.99693570824051	10.1977283384567	10.7732996952578	10.7751737033338;
0.00198990832208088	0.00760753219189724	0.0423022021203227	0.0818699992919351	0.149073299807369	0.249095378054131	0.392110406918202	0.584469276382622	0.800830662356103	1.05964281857637	1.26756071700739	1.38022647095275	1.42686716433904	1.47227678900224	1.5137429120922	1.63170332600722	1.76443699015518	2.06097111985804	2.27583743315189	2.51010409585194	2.74558534283875	2.98985441800002	3.23120874193773	3.47412731463376	3.73962893979343	4.08274756704535	4.26882994412112	4.56401657178006	4.93242871692047	5.2708615115536	5.57864011500351	6.18548106154217	6.91404538873028	7.51639529258644	8.62643929623663	9.33715962095613	10.2802727764224	10.9174309504807	10.8386505053411	7.88353287344754;
0.00124484556134755	0.00832495475568068	0.0363712342230098	0.115219396934997	0.156551007362246	0.264234311087779	0.418248277801209	0.582184037983269	0.79654561464931	1.02903268449056	1.17772713308995	1.29136892422506	1.37434454139725	1.46186629615399	1.53878400374641	1.74922760532911	1.97864092751896	2.23488399035272	2.31303442971542	2.6322474358653	2.84910084211854	3.03197789182787	3.46448913136125	3.64829158984041	3.98801928202117	4.23362454617159	4.54388307270328	4.88039610830602	5.33638252368407	5.77186321522013	6.29071283953135	6.87126653015414	7.85163457612449	8.58179014702988	9.6107127396772	10.2941962243988	11.1658400293582	11.3803187418729	11.6377406816154	13.9412385249029;
0.00121199878800121	0.01023343604671	0.0392078477197946	0.0901773151717294	0.157270501187677	0.2545324549308	0.393614070581325	0.575384229700824	0.790285578672573	1.05041325672619	1.18758281783738	1.38117336223833	1.48334729373359	1.61803324144905	1.61545107291808	1.7221316446333	1.92978011842379	2.18383330196052	2.4252601423823	2.70670102418543	2.93417468088391	3.3658740081736	3.69907040074233	4.02871726126238	4.23417617937073	4.58176309267772	4.86004416340271	5.30761357782882	5.69169203168341	6.22063705940834	6.72455889454486	7.07700615572026	8.02353887904969	8.73361124693144	9.50822801661847	10.1708133726111	11.4036752386645	11.7873702502726	13.7413004349783	14.2254633595921;
0.00188093670647983	0.0105844304335043	0.0453208221591234	0.0975436729626674	0.167506803743719	0.2608163172736	0.390651060391541	0.553641710081585	0.764737304637017	1.00477661513581	1.15255926847287	1.26671731850355	1.37872632357513	1.46942908701772	1.59005176608913	1.77215769122234	1.9541559088385	2.61345780571217	2.73787072203618	2.80397297849736	3.10658651208283	3.44699696247402	4.32312055376164	4.32115091702195	4.59850711001286	4.95840537048101	5.25999914463917	5.41607027464542	5.8757644866313	6.55558762116557	7.06320192991048	7.45133606046579	8.42720865904203	9.13930811466519	9.82419780574094	10.4795305860929	11.5195405864363	12.4030534111961	13.4782677165354	14.262125984252;
0.00104139546992971	0.0158951821579661	0.0559804719283971	0.0996301862577889	0.174655606275393	0.232723946352422	0.370538117180628	0.526184625188092	0.707402943603688	0.876469810327994	1.01476219751568	1.18477029309276	1.28341830936202	1.39367136119588	1.51888293344448	1.68553724615176	1.86883579847244	2.22568081739241	2.48563902300994	2.72764253009848	3.12013188677135	3.416265264968	3.97047189974435	4.28143577641482	4.75250300941257	5.05839191460153	5.48403773364315	5.75193056837083	6.30959189852976	6.88459479731056	7.61404861493097	7.75486455566295	8.53792617909679	9.14671077510537	9.89433309517542	10.5084066508299	11.5859561270892	12.4302792940795	13.8568799376012	14.0456023768085;
0.00135558756248411	0.00841656133788256	0.0356102642600506	0.0746844444932578	0.136745839717131	0.224393004316974	0.339385943152173	0.462550040447201	0.621875918847398	0.782107574094402	0.938547533026863	1.05628139575767	1.20872622028982	1.53437359670018	1.53345490404143	1.73602649380366	1.95047408634815	2.1926781536047	2.52535957607873	2.88584937142908	3.13414250893394	3.59632622608001	3.99066816472202	4.32382938926999	4.75351082642429	5.27578912362706	5.7696803819493	6.16288310336582	6.87119673256321	7.54832081443546	7.98465881993224	8.36982123141329	9.32104625406161	9.78795431830924	10.1025544235112	11.1871002501663	11.9117478839801	12.3449558160431	12.8450983197069	13.2441528066528;
0.000668896321070234	0.00608478128591711	0.0301623666812304	0.0625996547946573	0.112347342846641	0.187527759043279	0.282534557196241	0.384834135615898	0.518406978555481	0.666621669373121	0.822089670503819	1.00151573573015	1.18642922411995	1.28551799871795	1.41225150670145	1.58455756901932	1.79099493653816	2.06563446616362	2.24838201888776	2.49751667376188	2.90633530430057	3.22643048491845	3.51101697658924	3.78169413525245	4.14760977959811	4.42312298038696	4.85322818053198	5.30152213704158	5.81798638230747	6.31692478854045	6.68454927210914	6.91461339528111	7.76808278610323	8.46895002469557	9.05662693116092	9.47806011194765	10.1365877895206	10.2372141913332	12.4657474004012	13.628207541251;
0.000689447149566941	0.00549408622663106	0.0281701936510474	0.0606487496953168	0.105057231085353	0.168780532208635	0.2423320731118	0.335484088060367	0.435553081655982	0.5581202036545	0.688544144564107	0.833541277558911	0.923439266282668	1.02228731348694	1.14892630442063	1.35686409622515	1.55109199654018	1.74959853006601	1.95738513013051	2.22673261776241	2.44804849523999	2.74672297872983	3.05017924637229	3.28344175221811	3.68304396489449	3.89918585019296	4.32318713885932	4.60457597324545	4.98564744679929	5.31422465595566	5.63488924358221	5.7929243531076	6.48683618805671	7.12919452148227	7.76245353380719	8.12728248365105	8.77467641252331	8.91061004467786	9.38568617212583	10.8185820913094;
0.000955414012738854	0.00580142830486336	0.0247492464171764	0.0584404357097574	0.117985693522186	0.154577664212426	0.212887674754941	0.285755090689056	0.394415601093397	0.499602707071814	0.627275243505424	0.717327768637366	0.82680236944761	0.888202494705974	1.03220663265306	1.20175343380787	1.40437073138659	1.5899880250769	1.83718597495689	2.00860376486892	2.27787511339792	2.6079607933642	2.85346658338538	3.12258352176821	3.41586280171198	3.61089355642577	3.80069398075681	4.06199106908327	4.32668167192858	4.61373878286767	4.80307873832096	5.06898247635083	5.51171645974138	6.22707036513257	7.68065617012674	7.90649952777539	8.16625777904083	8.42436824396879	7.94178869114665	7.09430617700456;
0.000909573258546199	0.00480617213684943	0.0297932881412671	0.0747585920465165	0.102061704927621	0.135354981453765	0.184574963052165	0.219645158092973	0.306933622645231	0.390089713196672	0.436295835922934	0.549448878753326	0.557866798345781	0.697050275183971	0.741685697036512	0.891721800871389	1.00505576585961	1.31599508873758	1.39179660845611	1.55166011622019	1.77594035272188	1.95397794586713	2.16642069624099	2.46983915696062	3.05238208106186	3.11772135359958	3.55908009516257	3.3339739289664	3.502703440277	3.50992636778824	4.06837661000301	4.28493803040479	4.59333031537649	4.77206784874521	5.23048787682143	6.53818381872572	6.37240969228482	6.96736474432968	6.97659353588484	7.26315789473684];
rows = 5:5:200;
cols = 5:5:100; 

mask = zeros(20, 40, 3);
for i = 1:20
    for j = 1:40
        if (speedup(i,j) < 1)
            mask(i,j,:) = [1,0,0];
        else
            mask(i,j,:) = [0,1,0];
        end
    end
end

figure(1);
surf(rows, cols, speedup, 'CData', mask, 'FaceColor', 'interp');
xlabel("Matrix Size")
ylabel("Matrix Count")
zlabel("Speed up")

% hold on
% h1 = surf(nan, nan, 1, 'FaceColor', 'red', 'FaceAlpha', 0.3);
% h2 = surf(nan, nan, 1, 'FaceColor', 'green', 'FaceAlpha', 0.3);
% hold off
% legend([h1, h2], {'Negative speed up', 'Positive speed up'});



figure(2);
surf(rows, cols, speedup, 'CData', mask, 'FaceColor', 'interp');
colorbar;
clim([0 1]);  % Assuming speedup values range from 0 to 1
colormap lines  % Use red-green colormap for better distinction

% Set custom tick labels for colorbar
colorbar.TickLabels = {'Negative speed up', 'Positive speed up'};